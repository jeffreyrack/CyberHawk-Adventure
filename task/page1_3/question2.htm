<head>
<link rel=stylesheet href="../../style/main.css" type="text/css" />
<style type="text/css">
	#letter {font-size: 200%}
</style>
<script type="text/javascript">
	var marker = window.parent.task.closestMarker;
	var currPage = 2;

	//Ouyang: Randomize the order of letters. Automatically called every time the page is refreshed.
	var oriletters= "METAMORPHIC";
	var letters = new Array("M","E","T","A","M","O","R","P","H","I","C");

	for (var i = 0; i < letters.length; i++) {
		var pos1 = parseInt((letters.length)*Math.random());
		var pos2 = parseInt((letters.length)*Math.random());
		var temp = letters[pos1];
		letters[pos1] = letters[pos2];
		letters[pos2] = temp;
	}

	//Ouyang: Firefox does not seem to be able to find the function while IE has no problem with it. Maybe this should be moved earlier.
	function verifyAnswer()
	{
		//Ouyang: window.parent refer to index.html
		var answer = document.getElementById("textAnswer").value.toUpperCase();

		//hardcode page 2 in the getPageStatus call because the page does not know its order related to other pages
		// status 3 means the quesiton has been solved
		if ( marker.getPageStatus(currPage) != 3) {
			if ( answer == oriletters ) {
				window.parent.appendMessageToInfoBox("Nice Work.  Metamorphic Rocks. <span style='color:red'>New!</span> question appeared! [+100 points]", "yes");
				window.parent.task.reward(100);
				marker.addScore(100);
				marker.setPageStatus(currPage, 3);				
				window.parent.updatePageBar(currPage);				
			} else {
				window.parent.appendMessageToInfoBox(" You are very close. Try again.", "hint");
			}
		} else {
			window.parent.appendMessageToInfoBox("You've answered this question", "hint");
		}
	}
	
	function nextQuestion() {
		window.parent.document.getElementById("myframe").src="task/page1_3/question2_2.htm";
	}
	
</script>
</head>

<body>
<table border="0">
<tr height="20px" valign="middle">
	<th colspan="2">North FK Palm Canyon</th>
</tr>
<tr>
	<td colspan="2" align="center">		
		<img src="images/2-1.jpg" class="embedded" align="center"/>
	</td>
</tr>
<tr>
	<td width="2%"/>
	 
	<td>
		<br/>
		<p>
No pressure, but can you unscramble these letters to name the family of rocks found deep below the granite?
			<br />
		</p>
		<div id="letter" align="center">
		<script type="text/javascript">
			//Ouyang: Display the permutated letters
			if ( marker.getPageStatus(currPage) < 2 ) {
				for (var i = 0; i < letters.length; i++) {
					document.write(letters[i] + " ");
				}
			} else {
				document.write('<span style="color:blue">');
				for (var i = 0; i < oriletters.length; i++) {
					document.write(oriletters[i] + " ");
				}				
				document.write('</span>');
			}
		</script>		
		</div>
		<script type="text/javascript">
			if ( marker.getPageStatus(currPage) < 2 ) {				
				var content = '<br/> \
				<p> \
					Click on the "Submit" button when you are done. \
				</p> \
				<div id="answerBoard"> \
				<form> \
				<center> \
					<input type="TEXT" id="textAnswer" /> &nbsp;&nbsp; \
					<button onclick="verifyAnswer();">Submit</button> \
				</center> \
				</form> \
				</div> \
				';
				document.write(content);
			} else {
				var content = '<br/> \
				<center> \
					<button onclick="nextQuestion();">Next question</button> \
				</center>';
				document.write(content);			
			}
		</script>
	</td>
</tr>
</table>
</body>

